<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sports Scores Ticker</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: transparent;
  overflow: hidden;
  font-family: Arial, Helvetica, sans-serif;
}

.ticker-wrap {
  position: fixed;
  bottom: 0;
  width: 100%;
  height: 80px;
  background: rgba(0,0,0,0.35);
  display: flex;
  align-items: center;
  overflow: hidden;
  transition: opacity 0.8s ease;
}

.ticker-wrap.hidden {
  opacity: 0;
  pointer-events: none;
}

.ticker {
  white-space: nowrap;
  padding-left: 100%;
  font-size: 28px;
  color: white;
  opacity: 0;
}

.scroll {
  animation:
    fadeIn 1.5s ease forwards,
    scroll 70s linear forwards,
    fadeOut 1.5s ease forwards;
  animation-delay: 0s, 0s, 68.5s;
}

@keyframes scroll {
  from { transform: translateX(0); }
  to { transform: translateX(-100%); }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes fadeOut {
  from { opacity: 1; }
  to { opacity: 0; }
}

.live {
  color: #00ff7f;
  font-weight: bold;
}

.separator {
  margin: 0 18px;
  color: white;
}
</style>
</head>

<body>
<div class="ticker-wrap" id="tickerWrap">
  <div class="ticker" id="ticker">Loading today’s scores…</div>
</div>

<script>
const leagues = [
  { name: "NFL", url: "https://site.api.espn.com/apis/site/v2/sports/football/nfl/scoreboard" },
  { name: "NBA", url: "https://site.api.espn.com/apis/site/v2/sports/basketball/nba/scoreboard" },
  { name: "MLB", url: "https://site.api.espn.com/apis/site/v2/sports/baseball/mlb/scoreboard" },
  { name: "NHL", url: "https://site.api.espn.com/apis/site/v2/sports/hockey/nhl/scoreboard" }
];

const leagueColors = {
  NFL: "#013369",
  NBA: "#17408B",
  MLB: "#002D72",
  NHL: "#111111"
};

const PAUSE_BETWEEN_LOOPS = 3000;

async function fetchScores() {
  const segments = [];

  for (const league of leagues) {
    try {
      const proxyUrl =
        "https://api.allorigins.win/raw?url=" +
        encodeURIComponent(league.url);

      const res = await fetch(proxyUrl);
      const data = await res.json();

      // Regular season (2) + Playoffs (3)
      const events = (data.events || []).filter(
        e => e.season?.type === 2 || e.season?.type === 3
      );

      events.forEach(event => {
        const comp = event.competitions[0];
        const away = comp.competitors.find(t => t.homeAway === "away");
        const home = comp.competitors.find(t => t.homeAway === "home");
        const status = comp.status.type;

        const isLive = status.state === "in";
        const statusText = isLive ? "LIVE" : status.shortDetail;

        const color = leagueColors[league.name] || "#222";

        segments.push(`
          <span style="background:${color}; padding: 6px 12px; border-radius: 6px;">
            <img src="${away.team.logo}" style="height:22px; vertical-align:middle; margin-right:6px;">
            ${away.team.abbreviation} ${away.score}
            –
            ${home.score} ${home.team.abbreviation}
            <img src="${home.team.logo}" style="height:22px; vertical-align:middle; margin-left:6px;">
            <span class="${isLive ? 'live' : ''}">(${statusText})</span>
          </span>
        `);
      });

    } catch (err) {
      console.error(err);
    }
  }

  const tickerWrap = document.getElementById("tickerWrap");

  if (segments.length === 0) {
    tickerWrap.classList.add("hidden");
  } else {
    tickerWrap.classList.remove("hidden");
  }

  startTicker(
    segments.length
      ? segments.join('<span class="separator">|</span>')
      : ""
  );
}

function startTicker(content) {
  const ticker = document.getElementById("ticker");

  ticker.className = "ticker";
  ticker.innerHTML = content;

  void ticker.offsetWidth;

  if (content !== "") {
    ticker.classList.add("scroll");
  }

  setTimeout(fetchScores, 70000 + PAUSE_BETWEEN_LOOPS);
}

fetchScores();
</script>
</body>
</html>
