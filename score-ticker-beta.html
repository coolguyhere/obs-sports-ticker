<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NFL on FOX Style Ticker (OBS)</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<style>
html, body {
  margin: 0;
  padding: 0;
  background: transparent;
  overflow: hidden;
  font-family: Arial, Helvetica, sans-serif;
}

/* === BAR === */
.ticker-wrap {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 64px;
  background: linear-gradient(
    to bottom,
    rgba(20,20,20,0.9),
    rgba(5,5,5,0.9)
  );
  display: flex;
  align-items: center;
  overflow: hidden;
}

/* === STRIP === */
.ticker {
  display: inline-flex;
  align-items: center;
  white-space: nowrap;
  transform: translateX(100%);
  animation: scroll 65s linear infinite;
  font-size: 24px;
  color: #fff;
}

@keyframes scroll {
  from { transform: translateX(100%); }
  to   { transform: translateX(-100%); }
}

/* === GAME BLOCK === */
.game {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 8px 14px;
  background: linear-gradient(
    to bottom,
    #1e3a8a,
    #152c6b
  );
  border-radius: 4px;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.15);
  font-weight: bold;
}

/* === TEAMS === */
.team {
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.team-logo {
  width: 22px;
  height: 22px;
  object-fit: contain;
}

/* === SCORE === */
.score {
  font-weight: 900;
  letter-spacing: 0.5px;
}

/* === STATUS === */
.status {
  font-size: 16px;
  font-weight: normal;
  opacity: 0.85;
}

.live {
  color: #7CFC00;
  font-weight: bold;
}

/* === SEPARATOR === */
.separator {
  width: 2px;
  height: 36px;
  background: rgba(255,255,255,0.65);
  margin: 0 18px;
}
</style>
</head>

<body>

<div class="ticker-wrap" id="tickerWrap">
  <div class="ticker" id="ticker">Loading…</div>
</div>

<script>
/* ======================
   ORIGINAL PROXY LOGIC
   ====================== */

const PAUSE_BETWEEN_LOOPS = 3000;
const leagues = [
  { name: "NFL", url: "https://site.api.espn.com/apis/site/v2/sports/football/nfl/scoreboard" },
  { name: "NBA", url: "https://site.api.espn.com/apis/site/v2/sports/basketball/nba/scoreboard" },
  { name: "MLB", url: "https://site.api.espn.com/apis/site/v2/sports/baseball/mlb/scoreboard" },
  { name: "NHL", url: "https://site.api.espn.com/apis/site/v2/sports/hockey/nhl/scoreboard" }
];

function safe(o, p, f = "") {
  try { return p.split(".").reduce((x,k)=>x?.[k],o) ?? f; }
  catch { return f; }
}

async function fetchJson(url) {
  try {
    const r = await fetch(url, { cache: "no-store" });
    if (r.ok) return r.json();
  } catch {}
  try {
    const r2 = await fetch(
      "https://api.allorigins.win/raw?url=" + encodeURIComponent(url)
    );
    if (r2.ok) return r2.json();
  } catch {}
  return null;
}

/* === BUILD HTML === */
function buildTickerHtml(list) {
  const out = [];

  for (const it of list) {
    const awayImg = it.away.logo
      ? `<img src="${it.away.logo}" class="team-logo">`
      : "";

    const homeImg = it.home.logo
      ? `<img src="${it.home.logo}" class="team-logo">`
      : "";

    out.push(`
      <div class="game">
        <span class="team">${awayImg}${it.away.abbr}</span>
        <span class="score">${it.away.score}–${it.home.score}</span>
        <span class="team">${it.home.abbr}${homeImg}</span>
        <span class="status ${it.isLive ? "live" : ""}">${it.statusText}</span>
      </div>
    `);
  }

  return out.join(`<div class="separator"></div>`);
}

/* === START === */
let LAST=null, TS=0, CACHE_TTL=30000;

async function fetchScores() {
  const now = Date.now();
  if (LAST && now-TS<CACHE_TTL) return startTicker(buildTickerHtml(LAST));

  const items=[];
  for (const lg of leagues) {
    const data = await fetchJson(lg.url);
    if (!data) continue;

    for (const ev of data.events||[]) {
      const comp=safe(ev,"competitions.0");
      if(!comp) continue;

      const away=comp.competitors.find(t=>t.homeAway==="away");
      const home=comp.competitors.find(t=>t.homeAway==="home");

      items.push({
        away:{abbr:safe(away,"team.abbreviation"),logo:safe(away,"team.logo"),score:safe(away,"score")},
        home:{abbr:safe(home,"team.abbreviation"),logo:safe(home,"team.logo"),score:safe(home,"score")},
        isLive:safe(comp,"status.type.state")==="in",
        statusText:safe(comp,"status.type.shortDetail","")
      });
    }
  }

  LAST=items; TS=Date.now();
  startTicker(buildTickerHtml(items));
}

function startTicker(html) {
  const t=document.getElementById("ticker");
  t.innerHTML=html;
}

fetchScores();
</script>

</body>
</html>
